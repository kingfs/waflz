{"ruleset_id":"__na__","ruleset_version":"__na__","directive":[{"sec_rule":{"variable":[{"type":"REQUEST_LINE","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^(?i:(?:[a-z]{3,10}\\s+(?:\\w{3,7}?://[\\w\\-\\./]*(?::\\d+)?)?/[^?#]*(?:\\?[^#\\s]*)?(?:#[\\S]*)?|connect (?:\\d{1,3}\\.){3}\\d{1,3}\\.?(?::\\d+)?|options \\*)\\s+[\\w\\./]+|get /[^?#]*(?:\\?[^#\\s]*)?(?:#[\\S]*)?)$","is_regex":true,"is_negated":true,"_reserved_1":57094720},"action":{"id":"960911","msg":"Invalid HTTP Request Line","action_type":"BLOCK","accuracy":"9","maturity":"9","phase":1,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"4","tag":["OWASP_CRS/PROTOCOL_VIOLATION/INVALID_REQ","CAPEC-272"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.notice_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/INVALID_REQ-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"logdata":"%{request_line}","t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"WEBSERVER_ERROR_LOG","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINS","value":"Invalid URI in request","is_regex":false,"is_negated":false},"action":{"id":"981227","msg":"Apache Error: Invalid URI in Request.","action_type":"PASS","accuracy":"9","maturity":"9","phase":5,"rev":"1","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"4","tag":["OWASP_CRS/PROTOCOL_VIOLATION/INVALID_REQ","CAPEC-272"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.notice_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/INVALID_REQ-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"logdata":"%{request_line}","t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"FILES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"FILES","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"['\\\";=]","is_regex":true,"is_negated":false,"_reserved_1":57144624},"action":{"id":"960000","msg":"Attempted multipart/form-data bypass","action_type":"BLOCK","accuracy":"7","maturity":"9","phase":2,"rev":"1","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"2","tag":["OWASP_CRS/PROTOCOL_VIOLATION/INVALID_REQ","CAPEC-272"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/INVALID_REQ-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"logdata":"%{matched_var}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQBODY_ERROR","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"EQ","value":"0","is_regex":false,"is_negated":true},"action":{"id":"960912","msg":"Failed to parse request body.","action_type":"BLOCK","accuracy":"9","maturity":"9","phase":2,"rev":"1","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"2","tag":["OWASP_CRS/PROTOCOL_VIOLATION/INVALID_REQ","CAPEC-272"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/INVALID_REQ-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"logdata":"%{REQBODY_ERROR_MSG}","t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"MULTIPART_STRICT_ERROR","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"EQ","value":"0","is_regex":false,"is_negated":true},"action":{"id":"960914","msg":"Multipart request body failed strict validation: PE %{REQBODY_PROCESSOR_ERROR}, BQ %{MULTIPART_BOUNDARY_QUOTED}, BW %{MULTIPART_BOUNDARY_WHITESPACE}, DB %{MULTIPART_DATA_BEFORE}, DA %{MULTIPART_DATA_AFTER}, HF %{MULTIPART_HEADER_FOLDING}, LF %{MULTIPART_LF_LINE}, SM %{MULTIPART_SEMICOLON_MISSING}, IQ %{MULTIPART_INVALID_QUOTING}, IH %{MULTIPART_INVALID_HEADER_FOLDING}, FLE %{MULTIPART_FILE_LIMIT_EXCEEDED}","action_type":"BLOCK","accuracy":"7","maturity":"8","phase":2,"rev":"1","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"2","tag":["OWASP_CRS/PROTOCOL_VIOLATION/INVALID_REQ","CAPEC-272"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/INVALID_REQ-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"MULTIPART_UNMATCHED_BOUNDARY","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"EQ","value":"0","is_regex":false,"is_negated":true},"action":{"id":"960915","msg":"Multipart parser detected a possible unmatched boundary.","action_type":"BLOCK","accuracy":"8","maturity":"8","phase":2,"rev":"1","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"2","tag":["OWASP_CRS/PROTOCOL_VIOLATION/INVALID_REQ","CAPEC-272"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/INVALID_REQ-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Content-Length","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^\\d+$","is_regex":true,"is_negated":true,"_reserved_1":57152464},"action":{"id":"960016","msg":"Content-Length HTTP header is not numeric.","action_type":"BLOCK","accuracy":"9","maturity":"9","phase":1,"rev":"1","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"2","tag":["OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ","CAPEC-272"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"logdata":"%{matched_var}","t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_METHOD","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^(?:GET|HEAD)$","is_regex":true,"is_negated":false,"_reserved_1":57109088},"action":{"id":"960011","msg":"GET or HEAD Request with Body Content.","action_type":"BLOCK","accuracy":"9","maturity":"9","phase":1,"rev":"1","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"2","tag":["OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ","CAPEC-272"],"logdata":"%{matched_var}","t":["NONE"]},"chained_rule":[{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Content-Length","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^0?$","is_regex":true,"is_negated":true,"_reserved_1":57119376},"action":{"file":"modsecurity_crs_20_protocol_violations.conf","setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"t":["NONE"]},"hidden":false}],"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_METHOD","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^POST$","is_regex":true,"is_negated":false,"_reserved_1":57081424},"action":{"id":"960012","msg":"POST request missing Content-Length Header.","action_type":"BLOCK","accuracy":"9","maturity":"9","phase":1,"rev":"1","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"4","tag":["OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ","CAPEC-272"],"logdata":"%{matched_var}","t":["NONE"]},"chained_rule":[{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Content-Length","is_negated":false,"is_regex":false}],"is_count":true}],"operator":{"type":"EQ","value":"0","is_regex":false,"is_negated":false},"action":{"file":"modsecurity_crs_20_protocol_violations.conf","setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.notice_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"t":["NONE"]},"hidden":false}],"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Content-Encoding","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^Identity$","is_regex":true,"is_negated":false,"_reserved_1":57154464},"action":{"id":"960902","msg":"Invalid Use of Identity Encoding.","action_type":"BLOCK","accuracy":"9","maturity":"9","phase":1,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"4","tag":["OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ","CAPEC-272"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.notice_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"logdata":"%{matched_var}","t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Expect","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINS","value":"100-continue","is_regex":false,"is_negated":false},"action":{"id":"960022","msg":"Expect Header Not Allowed for HTTP 1.0.","action_type":"BLOCK","accuracy":"9","maturity":"7","phase":1,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"5","tag":["OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ","CAPEC-272"],"logdata":"%{matched_var}","t":["NONE"]},"chained_rule":[{"variable":[{"type":"REQUEST_PROTOCOL","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"STREQ","value":"HTTP/1.0","is_regex":false,"is_negated":false},"action":{"file":"modsecurity_crs_20_protocol_violations.conf","setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.notice_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"t":["NONE"]},"hidden":false}],"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Pragma","is_negated":false,"is_regex":false}],"is_count":true}],"operator":{"type":"EQ","value":"1","is_regex":false,"is_negated":false},"action":{"id":"960020","msg":"Pragma Header requires Cache-Control Header for HTTP/1.1 requests.","action_type":"BLOCK","accuracy":"8","maturity":"6","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"5","tag":["OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ"],"t":["NONE"]},"chained_rule":[{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Pragma","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"STRMATCH","value":"no-cache","is_regex":false,"is_negated":false},"action":{"file":"modsecurity_crs_20_protocol_violations.conf"},"hidden":false},{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Cache-Control","is_negated":false,"is_regex":false}],"is_count":true}],"operator":{"type":"EQ","value":"0","is_regex":false,"is_negated":false},"action":{"file":"modsecurity_crs_20_protocol_violations.conf"},"hidden":false},{"variable":[{"type":"REQUEST_PROTOCOL","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"STREQ","value":"HTTP/1.1","is_regex":false,"is_negated":false},"action":{"file":"modsecurity_crs_20_protocol_violations.conf","setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.notice_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}]},"hidden":false}],"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Range","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"BEGINSWITH","value":"bytes=0-","is_regex":false,"is_negated":false},"action":{"id":"958291","msg":"Range: field exists and begins with 0.","action_type":"BLOCK","accuracy":"8","maturity":"6","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"4","tag":["OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.warning_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"logdata":"%{matched_var}","t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Range","is_negated":false,"is_regex":false},{"value":"Request-Range","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(\\d+)\\-(\\d+)\\,","is_regex":true,"is_negated":false,"_reserved_1":57104976},"action":{"id":"958230","msg":"Range: Invalid Last Byte Value.","action_type":"BLOCK","capture":true,"accuracy":"8","maturity":"6","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"4","tag":["OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.warning_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"logdata":"%{matched_var}","t":["NONE"]},"chained_rule":[{"variable":[{"type":"TX","match":[{"value":"2","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"GE","value":"%{tx.1}","is_regex":false,"is_negated":true},"action":{"file":"modsecurity_crs_20_protocol_violations.conf"},"hidden":false}],"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Range","is_negated":false,"is_regex":false},{"value":"Request-Range","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^bytes=(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,","is_regex":true,"is_negated":false,"_reserved_1":57116992},"action":{"id":"958231","msg":"Range: Too many fields","action_type":"BLOCK","capture":true,"accuracy":"8","maturity":"6","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"4","tag":["OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.warning_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"logdata":"%{matched_var}","t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Connection","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"\\b(keep-alive|close),\\s?(keep-alive|close)\\b","is_regex":true,"is_negated":false,"_reserved_1":57072288},"action":{"id":"958295","msg":"Multiple/Conflicting Connection Header Data Found.","action_type":"BLOCK","accuracy":"8","maturity":"6","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"4","tag":["OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.warning_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/INVALID_HREQ-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"logdata":"%{matched_var}","t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_URI","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"\\%((?!$|\\W)|[0-9a-fA-F]{2}|u[0-9a-fA-F]{4})","is_regex":true,"is_negated":false,"_reserved_1":57092896},"action":{"id":"950107","msg":"URL Encoding Abuse Attack Attempt","action_type":"BLOCK","accuracy":"8","maturity":"6","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"4","tag":["OWASP_CRS/PROTOCOL_VIOLATION/EVASION"],"t":["NONE"]},"chained_rule":[{"variable":[{"type":"REQUEST_URI","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"VALIDATEURLENCODING","is_regex":false,"is_negated":false},"action":{"file":"modsecurity_crs_20_protocol_violations.conf","setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.warning_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/EVASION-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}]},"hidden":false}],"hidden":false}},{"sec_rule":{"variable":[{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"\\%((?!$|\\W)|[0-9a-fA-F]{2}|u[0-9a-fA-F]{4})","is_regex":true,"is_negated":false,"_reserved_1":57090800},"action":{"id":"950109","msg":"Multiple URL Encoding Detected","action_type":"BLOCK","accuracy":"8","maturity":"6","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"4","tag":["OWASP_CRS/PROTOCOL_VIOLATION/EVASION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.warning_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/EVASION-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Content-Type","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^(application\\/x-www-form-urlencoded|text\\/xml)(?:;(?:\\s?charset\\s?=\\s?[\\w\\d\\-]{1,18})?)??$","is_regex":true,"is_negated":false,"_reserved_1":57106672},"action":{"id":"950108","msg":"URL Encoding Abuse Attack Attempt","action_type":"BLOCK","accuracy":"8","maturity":"6","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"4","tag":["OWASP_CRS/PROTOCOL_VIOLATION/EVASION"],"t":["NONE"]},"chained_rule":[{"variable":[{"type":"REQUEST_BODY","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"\\%((?!$|\\W)|[0-9a-fA-F]{2}|u[0-9a-fA-F]{4})","is_regex":true,"is_negated":false,"_reserved_1":57119168},"action":{"file":"modsecurity_crs_20_protocol_violations.conf"},"hidden":false},{"variable":[{"type":"REQUEST_BODY","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"VALIDATEURLENCODING","is_regex":false,"is_negated":false},"action":{"file":"modsecurity_crs_20_protocol_violations.conf","setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.warning_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/EVASION-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}]},"hidden":false}],"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"CRS_VALIDATE_UTF8_ENCODING","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"EQ","value":"1","is_regex":false,"is_negated":false},"action":{"id":"950801","msg":"UTF8 Encoding Abuse Attack Attempt","action_type":"BLOCK","accuracy":"8","maturity":"6","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"4","tag":["OWASP_CRS/PROTOCOL_VIOLATION/EVASION"],"t":["NONE"]},"chained_rule":[{"variable":[{"type":"REQUEST_FILENAME","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"VALIDATEUTF8ENCODING","is_regex":false,"is_negated":false},"action":{"file":"modsecurity_crs_20_protocol_violations.conf","setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.warning_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/EVASION-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}]},"hidden":false}],"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_URI","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"REQUEST_BODY","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"\\%u[fF]{2}[0-9a-fA-F]{2}","is_regex":true,"is_negated":false,"_reserved_1":57138480},"action":{"id":"950116","msg":"Unicode Full/Half Width Abuse Attack Attempt","action_type":"BLOCK","accuracy":"8","maturity":"6","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"4","setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.warning_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/EVASION-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"REQUEST_HEADERS","match":[{"is_negated":false,"is_regex":false},{"value":"Referer","is_negated":true,"is_regex":false}],"is_count":false}],"operator":{"type":"VALIDATEBYTERANGE","value":"1-255","is_regex":false,"is_negated":false,"_reserved_1":57140960},"action":{"id":"960901","msg":"Invalid character in request","action_type":"BLOCK","accuracy":"9","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"3","tag":["OWASP_CRS/PROTOCOL_VIOLATION/EVASION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.error_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/EVASION-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"PARANOID_MODE","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"EQ","value":"1","is_regex":false,"is_negated":false},"action":{"id":"960018","msg":"Invalid character in request","action_type":"BLOCK","accuracy":"7","maturity":"8","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_20_protocol_violations.conf","severity":"3","tag":["OWASP_CRS/PROTOCOL_VIOLATION/EVASION"],"t":["NONE","URLDECODEUNI"]},"chained_rule":[{"variable":[{"type":"REQUEST_URI","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"REQUEST_BODY","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"REQUEST_HEADERS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"REQUEST_HEADERS","match":[{"is_negated":false,"is_regex":false},{"value":"Referer","is_negated":true,"is_regex":false}],"is_count":false},{"type":"TX","match":[{"value":"HPP_DATA","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"VALIDATEBYTERANGE","value":"32-126","is_regex":false,"is_negated":false,"_reserved_1":57144416},"action":{"file":"modsecurity_crs_20_protocol_violations.conf","setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.error_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/EVASION-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"t":["URLDECODEUNI"]},"hidden":false}],"hidden":false}}]}