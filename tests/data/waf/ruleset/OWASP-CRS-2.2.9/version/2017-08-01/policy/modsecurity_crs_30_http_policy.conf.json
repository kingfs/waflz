{"ruleset_id":"__na__","ruleset_version":"__na__","directive":[{"sec_rule":{"variable":[{"type":"REQUEST_METHOD","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"WITHIN","value":"%{tx.allowed_methods}","is_regex":false,"is_negated":true},"action":{"id":"960032","msg":"Method is not allowed by policy","action_type":"BLOCK","accuracy":"9","maturity":"9","phase":1,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_30_http_policy.conf","severity":"2","tag":["OWASP_CRS/POLICY/METHOD_NOT_ALLOWED","WASCTC/WASC-15","OWASP_TOP_10/A6","OWASP_AppSensor/RE1","PCI/12.1"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.inbound_anomaly_score_level}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/POLICY/METHOD_NOT_ALLOWED-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"logdata":"%{matched_var}","t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_METHOD","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^(?:GET|HEAD|PROPFIND|OPTIONS)$","is_regex":true,"is_negated":true,"_reserved_1":53592640},"action":{"id":"960010","msg":"Request content type is not allowed by policy","action_type":"BLOCK","accuracy":"9","maturity":"9","phase":1,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_30_http_policy.conf","severity":"2","tag":["OWASP_CRS/POLICY/ENCODING_NOT_ALLOWED","WASCTC/WASC-20","OWASP_TOP_10/A1","OWASP_AppSensor/EE2","PCI/12.1"],"logdata":"%{matched_var}","t":["NONE"]},"chained_rule":[{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Content-Type","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^([^;\\s]+)","is_regex":true,"is_negated":false,"_reserved_1":53589152},"action":{"capture":true,"file":"modsecurity_crs_30_http_policy.conf"},"hidden":false},{"variable":[{"type":"TX","match":[{"value":"0","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"WITHIN","value":"%{tx.allowed_request_content_type}","is_regex":true,"is_negated":true},"action":{"file":"modsecurity_crs_30_http_policy.conf","setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/POLICY/CONTENT_TYPE_NOT_ALLOWED-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"t":["NONE"],"force_request_body_variable":"On"},"hidden":false}],"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_PROTOCOL","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"WITHIN","value":"%{tx.allowed_http_versions}","is_regex":false,"is_negated":true},"action":{"id":"960034","msg":"HTTP protocol version is not allowed by policy","action_type":"BLOCK","accuracy":"9","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_30_http_policy.conf","severity":"2","tag":["OWASP_CRS/POLICY/PROTOCOL_NOT_ALLOWED","WASCTC/WASC-21","OWASP_TOP_10/A6","PCI/6.5.10"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.inbound_anomaly_score_level}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/POLICY/PROTOCOL_NOT_ALLOWED-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"logdata":"%{matched_var}","t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_BASENAME","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"\\.(.*)$","is_regex":true,"is_negated":false,"_reserved_1":53598880},"action":{"id":"960035","msg":"URL file extension is restricted by policy","action_type":"BLOCK","capture":true,"accuracy":"9","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_30_http_policy.conf","severity":"2","tag":["OWASP_CRS/POLICY/EXT_RESTRICTED","WASCTC/WASC-15","OWASP_TOP_10/A7","PCI/6.5.10"],"setvar":[{"scope":"TX","var":"extension","op":"ASSIGN","val":".%{tx.1}/"}],"logdata":"%{TX.0}","t":["NONE","URLDECODEUNI","LOWERCASE"]},"chained_rule":[{"variable":[{"type":"TX","match":[{"value":"EXTENSION","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"WITHIN","value":"%{tx.restricted_extensions}","is_regex":false,"is_negated":false},"action":{"file":"modsecurity_crs_30_http_policy.conf","setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.inbound_anomaly_score_level}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/POLICY/EXT_RESTRICTED-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"t":["NONE"]},"hidden":false}],"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_HEADERS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"WITHIN","value":"%{tx.restricted_headers}","is_regex":false,"is_negated":false},"action":{"id":"960038","msg":"HTTP header is restricted by policy","action_type":"BLOCK","capture":true,"accuracy":"9","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.8","file":"modsecurity_crs_30_http_policy.conf","severity":"4","tag":["OWASP_CRS/POLICY/HEADER_RESTRICTED","OWASP_CRS/POLICY/FILES_NOT_ALLOWED","WASCTC/WASC-21","OWASP_TOP_10/A7","PCI/12.1","WASCTC/WASC-15","OWASP_TOP_10/A7","PCI/12.1"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.inbound_anomaly_score_level}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/POLICY/HEADERS_RESTRICTED-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"logdata":"%{matched_var}","t":["NONE","MD5","HEXENCODE"]},"hidden":false}}]}