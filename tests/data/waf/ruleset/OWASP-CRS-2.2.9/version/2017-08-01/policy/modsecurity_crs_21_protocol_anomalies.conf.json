{"ruleset_id":"__na__","ruleset_version":"__na__","directive":[{"marker":"BEGIN_HOST_CHECK"},{"sec_rule":{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Host","is_negated":false,"is_regex":false}],"is_count":true}],"operator":{"type":"EQ","value":"0","is_regex":false,"is_negated":false},"action":{"id":"960008","msg":"Request Missing a Host Header","action_type":"BLOCK","accuracy":"9","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_21_protocol_anomalies.conf","severity":"4","tag":["OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_HOST","WASCTC/WASC-21","OWASP_TOP_10/A7","PCI/6.5.10"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.warning_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"t":["NONE"],"skipafter":"END_HOST_CHECK"},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Host","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^$","is_regex":true,"is_negated":false,"_reserved_1":66256096},"action":{"id":"960007","msg":"Empty Host Header","action_type":"BLOCK","accuracy":"9","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_21_protocol_anomalies.conf","severity":"4","tag":["OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_HOST"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.warning_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"t":["NONE"]},"hidden":false}},{"marker":"END_HOST_CHECK"},{"marker":"BEGIN_ACCEPT_CHECK"},{"sec_rule":{"variable":[{"type":"REQUEST_METHOD","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^OPTIONS$","is_regex":true,"is_negated":true,"_reserved_1":66271280},"action":{"id":"960015","msg":"Request Missing an Accept Header","action_type":"BLOCK","accuracy":"9","maturity":"9","phase":2,"rev":"1","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_21_protocol_anomalies.conf","severity":"5","tag":["OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT","WASCTC/WASC-21","OWASP_TOP_10/A7","PCI/6.5.10"],"t":["NONE"],"skipafter":"END_ACCEPT_CHECK"},"chained_rule":[{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Accept","is_negated":false,"is_regex":false}],"is_count":true}],"operator":{"type":"EQ","value":"0","is_regex":false,"is_negated":false},"action":{"file":"modsecurity_crs_21_protocol_anomalies.conf","setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.notice_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"t":["NONE"]},"hidden":false}],"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_METHOD","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^OPTIONS$","is_regex":true,"is_negated":true,"_reserved_1":66283264},"action":{"id":"960021","msg":"Request Has an Empty Accept Header","action_type":"BLOCK","accuracy":"9","maturity":"9","phase":2,"rev":"1","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_21_protocol_anomalies.conf","severity":"5","tag":["OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT"],"t":["NONE"]},"chained_rule":[{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Accept","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^$","is_regex":true,"is_negated":false,"_reserved_1":66283488},"action":{"file":"modsecurity_crs_21_protocol_anomalies.conf","setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.notice_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"t":["NONE"]},"hidden":false}],"hidden":false}},{"marker":"END_ACCEPT_CHECK"},{"marker":"BEGIN_UA_CHECK"},{"sec_rule":{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"User-Agent","is_negated":false,"is_regex":false}],"is_count":true}],"operator":{"type":"EQ","value":"0","is_regex":false,"is_negated":false},"action":{"id":"960009","msg":"Request Missing a User Agent Header","action_type":"BLOCK","accuracy":"9","maturity":"9","phase":2,"rev":"1","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_21_protocol_anomalies.conf","severity":"5","tag":["OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_UA","WASCTC/WASC-21","OWASP_TOP_10/A7","PCI/6.5.10"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.notice_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"t":["NONE"],"skipafter":"END_UA_CHECK"},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"User-Agent","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^$","is_regex":true,"is_negated":false,"_reserved_1":66262816},"action":{"id":"960006","msg":"Empty User Agent Header","action_type":"BLOCK","accuracy":"9","maturity":"9","phase":2,"rev":"1","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_21_protocol_anomalies.conf","severity":"5","tag":["OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_UA"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.notice_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"t":["NONE"]},"hidden":false}},{"marker":"END_UA_CHECK"},{"sec_rule":{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Content-Type","is_negated":false,"is_regex":false}],"is_count":true}],"operator":{"type":"EQ","value":"0","is_regex":false,"is_negated":false},"action":{"id":"960904","msg":"Request Containing Content, but Missing Content-Type header","action_type":"BLOCK","accuracy":"9","maturity":"9","phase":1,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_21_protocol_anomalies.conf","severity":"5","t":["NONE"]},"chained_rule":[{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Content-Length","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^0$","is_regex":true,"is_negated":true,"_reserved_1":66281600},"action":{"file":"modsecurity_crs_21_protocol_anomalies.conf","setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.notice_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"t":["NONE"],"force_request_body_variable":"On"},"hidden":false}],"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Host","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^[\\d.:]+$","is_regex":true,"is_negated":false,"_reserved_1":66263488},"action":{"id":"960017","msg":"Host header is a numeric IP address","action_type":"BLOCK","accuracy":"9","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_21_protocol_anomalies.conf","severity":"4","tag":["OWASP_CRS/PROTOCOL_VIOLATION/IP_HOST","WASCTC/WASC-21","OWASP_TOP_10/A7","PCI/6.5.10","http://technet.microsoft.com/en-us/magazine/2005.01.hackerbasher.aspx"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.warning_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/POLICY/IP_HOST-%{matched_var_name}","op":"ASSIGN","val":"%{matched_var}"}],"logdata":"%{matched_var}","t":["NONE"]},"hidden":false}}]}