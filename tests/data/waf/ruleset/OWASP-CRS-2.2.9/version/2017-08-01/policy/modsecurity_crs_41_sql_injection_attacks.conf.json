{"ruleset_id":"__na__","ruleset_version":"__na__","directive":[{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":61997632}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(/\\*!?|\\*/|[';]--|--[\\s\\r\\n\\v\\f]|(?:--[^-]*?-)|([^\\-&])#.*?[\\s\\r\\n\\v\\f]|;?\\\\x00)","is_regex":true,"is_negated":false,"_reserved_1":62059440},"action":{"id":"981231","msg":"SQL Comment Sequence Detected.","action_type":"BLOCK","capture":true,"accuracy":"8","maturity":"8","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"setvar":[{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62012560}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:\\A|[^\\d])0x[a-f\\d]{3,}[a-f\\d]*)+","is_regex":true,"is_negated":false,"_reserved_1":61981568},"action":{"id":"981260","msg":"SQL Hex Encoding Identified","action_type":"BLOCK","capture":true,"accuracy":"8","maturity":"8","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62021504}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(^[\\\"'`´’‘;]+|[\\\"'`´’‘;]+$)","is_regex":true,"is_negated":false,"_reserved_1":62163136},"action":{"id":"981318","msg":"SQL Injection Attack: Common Injection Testing Detected","action_type":"BLOCK","capture":true,"accuracy":"8","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62150128}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(\\!\\=|\\&\\&|\\|\\||>>|<<|>=|<=|<>|<=>|xor|rlike|regexp|isnull)|(?:not\\s+between\\s+0\\s+and)|(?:is\\s+null)|(like\\s+null)|(?:(?:^|\\W)in[+\\s]*\\([\\s\\d\\\"]+[^()]*\\))|(?:xor|<>|rlike(?:\\s+binary)?)|(?:regexp\\s+binary))","is_regex":true,"is_negated":false,"_reserved_1":62070448},"action":{"id":"981319","msg":"SQL Injection Attack: SQL Operator Detected","action_type":"BLOCK","capture":true,"accuracy":"8","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"%{tx.notice_anomaly_score}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.notice_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62185936}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:([\\s'\\\"`´’‘\\(\\)]*?)\\b([\\d\\w]++)([\\s'\\\"`´’‘\\(\\)]*?)(?:(?:=|<=>|r?like|sounds\\s+like|regexp)([\\s'\\\"`´’‘\\(\\)]*?)\\2\\b|(?:!=|<=|>=|<>|<|>|\\^|is\\s+not|not\\s+like|not\\s+regexp)([\\s'\\\"`´’‘\\(\\)]*?)(?!\\2)([\\d\\w]+)\\b))","is_regex":true,"is_negated":false,"_reserved_1":62189376},"action":{"id":"950901","msg":"SQL Injection Attack: SQL Tautology Detected.","action_type":"BLOCK","capture":true,"multimatch":true,"accuracy":"8","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI","REPLACECOMMENTS"],"audit_log_parts":"+E"},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62192640}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:m(?:s(?:ysaccessobjects|ysaces|ysobjects|ysqueries|ysrelationships|ysaccessstorage|ysaccessxml|ysmodules|ysmodules2|db)|aster\\.\\.sysdatabases|ysql\\.db)|s(?:ys(?:\\.database_name|aux)|chema(?:\\W*\\(|_name)|qlite(_temp)?_master)|d(?:atabas|b_nam)e\\W*\\(|information_schema|pg_(catalog|toast)|northwind|tempdb))","is_regex":true,"is_negated":false,"_reserved_1":62206496},"action":{"id":"981320","msg":"SQL Injection Attack: Common DB Names Detected","action_type":"BLOCK","capture":true,"accuracy":"8","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"],"audit_log_parts":"+E"},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62207232}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"PM","value":"select show top distinct from dual where group by order having limit offset union rownum as (case","is_regex":false,"is_negated":false,"_reserved_1":62269904},"action":{"id":"981300","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","setvar":[{"scope":"TX","var":"sqli_select_statement","op":"ASSIGN","val":"%{tx.sqli_select_statement} %{matched_var}"}],"t":["NONE","URLDECODEUNI","LOWERCASE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"SQLI_SELECT_STATEMENT","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINSWORD","value":"select","is_regex":false,"is_negated":false},"action":{"id":"981301","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","setvar":[{"scope":"TX","var":"sqli_select_statement_count","op":"INCREMENT","val":"1"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"SQLI_SELECT_STATEMENT","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINSWORD","value":"show","is_regex":false,"is_negated":false},"action":{"id":"981302","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","setvar":[{"scope":"TX","var":"sqli_select_statement_count","op":"INCREMENT","val":"1"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"SQLI_SELECT_STATEMENT","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINSWORD","value":"top","is_regex":false,"is_negated":false},"action":{"id":"981303","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","setvar":[{"scope":"TX","var":"sqli_select_statement_count","op":"INCREMENT","val":"1"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"SQLI_SELECT_STATEMENT","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINSWORD","value":"distinct","is_regex":false,"is_negated":false},"action":{"id":"981304","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","setvar":[{"scope":"TX","var":"sqli_select_statement_count","op":"INCREMENT","val":"1"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"SQLI_SELECT_STATEMENT","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINSWORD","value":"from","is_regex":false,"is_negated":false},"action":{"id":"981305","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","setvar":[{"scope":"TX","var":"sqli_select_statement_count","op":"INCREMENT","val":"1"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"SQLI_SELECT_STATEMENT","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINSWORD","value":"dual","is_regex":false,"is_negated":false},"action":{"id":"981306","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","setvar":[{"scope":"TX","var":"sqli_select_statement_count","op":"INCREMENT","val":"1"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"SQLI_SELECT_STATEMENT","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINSWORD","value":"where","is_regex":false,"is_negated":false},"action":{"id":"981307","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","setvar":[{"scope":"TX","var":"sqli_select_statement_count","op":"INCREMENT","val":"1"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"SQLI_SELECT_STATEMENT","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINS","value":"group by","is_regex":false,"is_negated":false},"action":{"id":"981308","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","setvar":[{"scope":"TX","var":"sqli_select_statement_count","op":"INCREMENT","val":"1"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"SQLI_SELECT_STATEMENT","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINS","value":"order by","is_regex":false,"is_negated":false},"action":{"id":"981309","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","setvar":[{"scope":"TX","var":"sqli_select_statement_count","op":"INCREMENT","val":"1"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"SQLI_SELECT_STATEMENT","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINSWORD","value":"having","is_regex":false,"is_negated":false},"action":{"id":"981310","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","setvar":[{"scope":"TX","var":"sqli_select_statement_count","op":"INCREMENT","val":"1"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"SQLI_SELECT_STATEMENT","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINSWORD","value":"limit","is_regex":false,"is_negated":false},"action":{"id":"981311","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","setvar":[{"scope":"TX","var":"sqli_select_statement_count","op":"INCREMENT","val":"1"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"SQLI_SELECT_STATEMENT","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINSWORD","value":"offset","is_regex":false,"is_negated":false},"action":{"id":"981312","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","setvar":[{"scope":"TX","var":"sqli_select_statement_count","op":"INCREMENT","val":"1"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"SQLI_SELECT_STATEMENT","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINSWORD","value":"union","is_regex":false,"is_negated":false},"action":{"id":"981313","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","setvar":[{"scope":"TX","var":"sqli_select_statement_count","op":"INCREMENT","val":"1"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"SQLI_SELECT_STATEMENT","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINS","value":"union all","is_regex":false,"is_negated":false},"action":{"id":"981314","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","setvar":[{"scope":"TX","var":"sqli_select_statement_count","op":"INCREMENT","val":"1"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"SQLI_SELECT_STATEMENT","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINS","value":"rownum as","is_regex":false,"is_negated":false},"action":{"id":"981315","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","setvar":[{"scope":"TX","var":"sqli_select_statement_count","op":"INCREMENT","val":"1"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"SQLI_SELECT_STATEMENT","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINS","value":"(case","is_regex":false,"is_negated":false},"action":{"id":"981316","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","setvar":[{"scope":"TX","var":"sqli_select_statement_count","op":"INCREMENT","val":"1"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"}],"t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"TX","match":[{"value":"SQLI_SELECT_STATEMENT_COUNT","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"GE","value":"3","is_regex":false,"is_negated":false},"action":{"id":"981317","msg":"SQL SELECT Statement Anomaly Detection Alert","action_type":"BLOCK","accuracy":"8","maturity":"8","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_41_sql_injection_attacks.conf","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"setvar":[{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.warning_anomaly_score}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62286912}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:\\b(?:(?:s(?:ys\\.(?:user_(?:(?:t(?:ab(?:_column|le)|rigger)|object|view)s|c(?:onstraints|atalog))|all_tables|tab)|elect\\b.{0,40}\\b(?:substring|users?|ascii))|m(?:sys(?:(?:queri|ac)e|relationship|column|object)s|ysql\\.(db|user))|c(?:onstraint_type|harindex)|waitfor\\b\\W*?\\bdelay|attnotnull)\\b|(?:locate|instr)\\W+\\()|\\@\\@spid\\b)|\\b(?:(?:s(?:ys(?:(?:(?:process|tabl)e|filegroup|object)s|c(?:o(?:nstraint|lumn)s|at)|dba|ibm)|ubstr(?:ing)?)|user_(?:(?:(?:constrain|objec)t|tab(?:_column|le)|ind_column|user)s|password|group)|a(?:tt(?:rel|typ)id|ll_objects)|object_(?:(?:nam|typ)e|id)|pg_(?:attribute|class)|column_(?:name|id)|xtype\\W+\\bchar|mb_users|rownum)\\b|t(?:able_name\\b|extpos\\W+\\()))","is_regex":true,"is_negated":false,"_reserved_1":62296272},"action":{"id":"950007","msg":"Blind SQL Injection Attack","action_type":"BLOCK","capture":true,"accuracy":"8","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"],"audit_log_parts":"+E"},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62301744}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:\\b(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4|ipv6|not_null|not|null|used_lock))?|n(?:et6?_(aton|ntoa)|s(?:ert|tr)|terval)?|f(null)?)|u(?:n(?:compress(?:ed_length)?|ix_timestamp|hex)|tc_(date|time|timestamp)|p(?:datexml|per)|uid(_short)?|case|ser)|l(?:o(?:ca(?:l(timestamp)?|te)|g(2|10)?|ad_file|wer)|ast(_day|_insert_id)?|e(?:(?:as|f)t|ngth)|case|trim|pad|n)|t(?:ime(stamp|stampadd|stampdiff|diff|_format|_to_sec)?|o_(base64|days|seconds|n?char)|r(?:uncate|im)|an)|m(?:a(?:ke(?:_set|date)|ster_pos_wait|x)|i(?:(?:crosecon)?d|n(?:ute)?)|o(?:nth(name)?|d)|d5)|r(?:e(?:p(?:lace|eat)|lease_lock|verse)|o(?:w_count|und)|a(?:dians|nd)|ight|trim|pad)|f(?:i(?:eld(_in_set)?|nd_in_set)|rom_(base64|days|unixtime)|o(?:und_rows|rmat)|loor)|a(?:es_(?:de|en)crypt|s(?:cii(str)?|in)|dd(?:dat|tim)e|(?:co|b)s|tan2?|vg)|p(?:o(?:sition|w(er)?)|eriod_(add|diff)|rocedure_analyse|assword|i)|b(?:i(?:t_(?:length|count|x?or|and)|n(_to_num)?)|enchmark)|e(?:x(?:p(?:ort_set)?|tract(value)?)|nc(?:rypt|ode)|lt)|v(?:a(?:r(?:_(?:sam|po)p|iance)|lues)|ersion)|g(?:r(?:oup_conca|eates)t|et_(format|lock))|o(?:(?:ld_passwo)?rd|ct(et_length)?)|we(?:ek(day|ofyear)?|ight_string)|n(?:o(?:t_in|w)|ame_const|ullif)|(rawton?)?hex(toraw)?|qu(?:arter|ote)|(pg_)?sleep|year(week)?|d?count|xmltype|hour)\\W*\\(|\\b(?:(?:s(?:elect\\b(?:.{1,100}?\\b(?:(?:length|count|top)\\b.{1,100}?\\bfrom|from\\b.{1,100}?\\bwhere)|.*?\\b(?:d(?:ump\\b.*\\bfrom|ata_type)|(?:to_(?:numbe|cha)|inst)r))|p_(?:sqlexec|sp_replwritetovarbin|sp_help|addextendedproc|is_srvrolemember|prepare|sp_password|execute(?:sql)?|makewebtask|oacreate)|ql_(?:longvarchar|variant))|xp_(?:reg(?:re(?:movemultistring|ad)|delete(?:value|key)|enum(?:value|key)s|addmultistring|write)|terminate|xp_servicecontrol|xp_ntsec_enumdomains|xp_terminate_process|e(?:xecresultset|numdsn)|availablemedia|loginconfig|cmdshell|filelist|dirtree|makecab|ntsec)|u(?:nion\\b.{1,100}?\\bselect|tl_(?:file|http))|d(?:b(?:a_users|ms_java)|elete\\b\\W*?\\bfrom)|group\\b.*\\bby\\b.{1,100}?\\bhaving|open(?:rowset|owa_util|query)|load\\b\\W*?\\bdata\\b.*\\binfile|(?:n?varcha|tbcreato)r|autonomous_transaction)\\b|i(?:n(?:to\\b\\W*?\\b(?:dump|out)file|sert\\b\\W*?\\binto|ner\\b\\W*?\\bjoin)\\b|(?:f(?:\\b\\W*?\\(\\W*?\\bbenchmark|null\\b)|snull\\b)\\W*?\\()|print\\b\\W*?\\@\\@|cast\\b\\W*?\\()|c(?:(?:ur(?:rent_(?:time(?:stamp)?|date|user)|(?:dat|tim)e)|h(?:ar(?:(?:acter)?_length|set)?|r)|iel(?:ing)?|ast|r32)\\W*\\(|o(?:(?:n(?:v(?:ert(?:_tz)?)?|cat(?:_ws)?|nection_id)|(?:mpres)?s|ercibility|alesce|t)\\W*\\(|llation\\W*\\(a))|d(?:(?:a(?:t(?:e(?:(_(add|format|sub))?|diff)|abase)|y(name|ofmonth|ofweek|ofyear)?)|e(?:(?:s_(de|en)cryp|faul)t|grees|code)|ump)\\W*\\(|bms_\\w+\\.\\b)|(?:;\\W*?\\b(?:shutdown|drop)|\\@\\@version)\\b|\\butl_inaddr\\b|\\bsys_context\\b|'(?:s(?:qloledb|a)|msdasql|dbo)'))","is_regex":true,"is_negated":false,"_reserved_1":62338544},"action":{"id":"950001","msg":"SQL Injection Attack","action_type":"BLOCK","capture":true,"accuracy":"8","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"],"audit_log_parts":"+E"},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62516816}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"\\b(?i:having)\\b\\s+(\\d{1,10}|'[^=]{1,10}')\\s*?[=<>]|(?i:\\bexecute(\\s{1,5}[\\w\\.$]{1,5}\\s{0,3})?\\()|\\bhaving\\b ?(?:\\d{1,10}|[\\'\\\"][^=]{1,10}[\\'\\\"]) ?[=<>]+|(?i:\\bcreate\\s+?table.{0,20}?\\()|(?i:\\blike\\W*?char\\W*?\\()|(?i:(?:(select(.*?)case|from(.*?)limit|order\\sby)))|exists\\s(\\sselect|select\\Sif(null)?\\s\\(|select\\Stop|select\\Sconcat|system\\s\\(|\\b(?i:having)\\b\\s+(\\d{1,10})|'[^=]{1,10}')","is_regex":true,"is_negated":false,"_reserved_1":62519456},"action":{"id":"959070","msg":"SQL Injection Attack","action_type":"BLOCK","capture":true,"accuracy":"8","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"],"audit_log_parts":"+E"},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62578432}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:\\bor\\b ?(?:\\d{1,10}|[\\'\\\"][^=]{1,10}[\\'\\\"]) ?[=<>]+|(?i:'\\s+x?or\\s+.{1,20}[+\\-!<>=])|\\b(?i:x?or)\\b\\s+(\\d{1,10}|'[^=]{1,10}')|\\b(?i:x?or)\\b\\s+(\\d{1,10}|'[^=]{1,10}')\\s*?[=<>])","is_regex":true,"is_negated":false,"_reserved_1":62569008},"action":{"id":"959071","msg":"SQL Injection Attack","action_type":"BLOCK","capture":true,"accuracy":"8","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"],"audit_log_parts":"+E"},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62569984}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i)\\b(?i:and)\\b\\s+(\\d{1,10}|'[^=]{1,10}')\\s*?[=]|\\b(?i:and)\\b\\s+(\\d{1,10}|'[^=]{1,10}')\\s*?[<>]|\\band\\b ?(?:\\d{1,10}|[\\'\\\"][^=]{1,10}[\\'\\\"]) ?[=<>]+|\\b(?i:and)\\b\\s+(\\d{1,10}|'[^=]{1,10}')","is_regex":true,"is_negated":false,"_reserved_1":62525232},"action":{"id":"959072","msg":"SQL Injection Attack","action_type":"BLOCK","capture":true,"accuracy":"8","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"],"audit_log_parts":"+E"},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62526160}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false},{"type":"REQUEST_HEADERS","match":[{"value":"via","is_negated":true,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:\\b(?:coalesce\\b|root\\@))","is_regex":true,"is_negated":false,"_reserved_1":62534000},"action":{"id":"950908","msg":"SQL Injection Attack.","action_type":"BLOCK","capture":true,"accuracy":"8","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_41_sql_injection_attacks.conf","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"],"audit_log_parts":"+E"},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62533360}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4|ipv6|not_null|not|null|used_lock))?|n(?:et6?_(aton|ntoa)|s(?:ert|tr)|terval)?|f(null)?)|u(?:n(?:compress(?:ed_length)?|ix_timestamp|hex)|tc_(date|time|timestamp)|p(?:datexml|per)|uid(_short)?|case|ser)|l(?:o(?:ca(?:l(timestamp)?|te)|g(2|10)?|ad_file|wer)|ast(_day|_insert_id)?|e(?:(?:as|f)t|ngth)|case|trim|pad|n)|t(?:ime(stamp|stampadd|stampdiff|diff|_format|_to_sec)?|o_(base64|days|seconds|n?char)|r(?:uncate|im)|an)|m(?:a(?:ke(?:_set|date)|ster_pos_wait|x)|i(?:(?:crosecon)?d|n(?:ute)?)|o(?:nth(name)?|d)|d5)|r(?:e(?:p(?:lace|eat)|lease_lock|verse)|o(?:w_count|und)|a(?:dians|nd)|ight|trim|pad)|f(?:i(?:eld(_in_set)?|nd_in_set)|rom_(base64|days|unixtime)|o(?:und_rows|rmat)|loor)|a(?:es_(?:de|en)crypt|s(?:cii(str)?|in)|dd(?:dat|tim)e|(?:co|b)s|tan2?|vg)|p(?:o(?:sition|w(er)?)|eriod_(add|diff)|rocedure_analyse|assword|i)|b(?:i(?:t_(?:length|count|x?or|and)|n(_to_num)?)|enchmark)|e(?:x(?:p(?:ort_set)?|tract(value)?)|nc(?:rypt|ode)|lt)|v(?:a(?:r(?:_(?:sam|po)p|iance)|lues)|ersion)|g(?:r(?:oup_conca|eates)t|et_(format|lock))|o(?:(?:ld_passwo)?rd|ct(et_length)?)|we(?:ek(day|ofyear)?|ight_string)|n(?:o(?:t_in|w)|ame_const|ullif)|(rawton?)?hex(toraw)?|qu(?:arter|ote)|(pg_)?sleep|year(week)?|d?count|xmltype|hour)\\W*?\\(|\\b(?:(?:s(?:elect\\b(?:.{1,100}?\\b(?:(?:length|count|top)\\b.{1,100}?\\bfrom|from\\b.{1,100}?\\bwhere)|.*?\\b(?:d(?:ump\\b.*?\\bfrom|ata_type)|(?:to_(?:numbe|cha)|inst)r))|p_(?:sqlexec|sp_replwritetovarbin|sp_help|addextendedproc|is_srvrolemember|prepare|sp_password|execute(?:sql)?|makewebtask|oacreate)|ql_(?:longvarchar|variant))|xp_(?:reg(?:re(?:movemultistring|ad)|delete(?:value|key)|enum(?:value|key)s|addmultistring|write)|terminate|xp_servicecontrol|xp_ntsec_enumdomains|xp_terminate_process|e(?:xecresultset|numdsn)|availablemedia|loginconfig|cmdshell|filelist|dirtree|makecab|ntsec)|u(?:nion\\b.{1,100}?\\bselect|tl_(?:file|http))|d(?:b(?:a_users|ms_java)|elete\\b\\W*?\\bfrom)|group\\b.*?\\bby\\b.{1,100}?\\bhaving|open(?:rowset|owa_util|query)|load\\b\\W*?\\bdata\\b.*?\\binfile|(?:n?varcha|tbcreato)r|autonomous_transaction)\\b|i(?:n(?:to\\b\\W*?\\b(?:dump|out)file|sert\\b\\W*?\\binto|ner\\b\\W*?\\bjoin)\\b|(?:f(?:\\b\\W*?\\(\\W*?\\bbenchmark|null\\b)|snull\\b)\\W*?\\()|print\\b\\W*?\\@\\@|cast\\b\\W*?\\()|c(?:(?:ur(?:rent_(?:time(?:stamp)?|date|user)|(?:dat|tim)e)|h(?:ar(?:(?:acter)?_length|set)?|r)|iel(?:ing)?|ast|r32)\\W*?\\(|o(?:(?:n(?:v(?:ert(?:_tz)?)?|cat(?:_ws)?|nection_id)|(?:mpres)?s|ercibility|alesce|t)\\W*?\\(|llation\\W*?\\(a))|d(?:(?:a(?:t(?:e(?:(_(add|format|sub))?|diff)|abase)|y(name|ofmonth|ofweek|ofyear)?)|e(?:(?:s_(de|en)cryp|faul)t|grees|code)|ump)\\W*?\\(|bms_\\w+\\.\\b)|(?:;\\W*?\\b(?:shutdown|drop)|\\@\\@version)\\b|\\butl_inaddr\\b|\\bsys_context\\b|'(?:s(?:qloledb|a)|msdasql|dbo)'))","is_regex":true,"is_negated":false,"_reserved_1":62557792},"action":{"id":"959073","msg":"SQL Injection Attack","action_type":"BLOCK","capture":true,"accuracy":"8","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"],"audit_log_parts":"+E"},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62514512},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62514848}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\\\"\\'\\´\\’\\‘\\`\\<\\>].*?){8,}","is_regex":true,"is_negated":false,"_reserved_1":62419136},"action":{"id":"981172","msg":"Restricted SQL Character Anomaly Detection Alert - Total # of special characters exceeded","action_type":"BLOCK","capture":true,"accuracy":"8","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_41_sql_injection_attacks.conf","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.warning_anomaly_score}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/WEB_ATTACK/RESTRICTED_SQLI_CHARS-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\\\"\\'\\´\\’\\‘\\`\\<\\>].*?){4,}","is_regex":true,"is_negated":false,"_reserved_1":62421456},"action":{"id":"981173","msg":"Restricted SQL Character Anomaly Detection Alert - Total # of special characters exceeded","action_type":"BLOCK","capture":true,"accuracy":"8","maturity":"9","phase":2,"rev":"2","ver":"OWASP_CRS/2.2.9","file":"modsecurity_crs_41_sql_injection_attacks.conf","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.warning_anomaly_score}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.msg}"},{"scope":"TX","var":"%{rule.id}-OWASP_CRS/WEB_ATTACK/RESTRICTED_SQLI_CHARS-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62422192}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(sleep\\((\\s*?)(\\d*?)(\\s*?)\\)|benchmark\\((.*?)\\,(.*?)\\)))","is_regex":true,"is_negated":false,"_reserved_1":62425472},"action":{"id":"981272","msg":"Detects blind sqli tests using sleep() or benchmark().","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62444720}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?i:\\d[\\\"'`´’‘]\\s+[\\\"'`´’‘]\\s+\\d)|(?:^admin\\s*?[\\\"'`´’‘]|(\\/\\*)+[\\\"'`´’‘]+\\s?(?:--|#|\\/\\*|{)?)|(?:[\\\"'`´’‘]\\s*?\\b(x?or|div|like|between|and)\\b\\s*?[+<>=(),-]\\s*?[\\d\\\"'`´’‘])|(?:[\\\"'`´’‘]\\s*?[^\\w\\s]?=\\s*?[\\\"'`´’‘])|(?:[\\\"'`´’‘]\\W*?[+=]+\\W*?[\\\"'`´’‘])|(?:[\\\"'`´’‘]\\s*?[!=|][\\d\\s!=+-]+.*?[\\\"'`´’‘(].*?$)|(?:[\\\"'`´’‘]\\s*?[!=|][\\d\\s!=]+.*?\\d+$)|(?:[\\\"'`´’‘]\\s*?like\\W+[\\w\\\"'`´’‘(])|(?:\\sis\\s*?0\\W)|(?:where\\s[\\s\\w\\.,-]+\\s=)|(?:[\\\"'`´’‘][<>~]+[\\\"'`´’‘]))","is_regex":true,"is_negated":false,"_reserved_1":62483840},"action":{"id":"981244","msg":"Detects basic SQL authentication bypass attempts 1/3","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62484960}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:\\sexec\\s+xp_cmdshell)|(?:[\\\"'`´’‘]\\s*?!\\s*?[\\\"'`´’‘\\w])|(?:from\\W+information_schema\\W)|(?:(?:(?:current_)?user|database|schema|connection_id)\\s*?\\([^\\)]*?)|(?:[\\\"'`´’‘];?\\s*?(?:select|union|having)\\s*?[^\\s])|(?:\\wiif\\s*?\\()|(?:exec\\s+master\\.)|(?:union select @)|(?:union[\\w(\\s]*?select)|(?:select.*?\\w?user\\()|(?:into[\\s+]+(?:dump|out)file\\s*?[\\\"'`´’‘]))","is_regex":true,"is_negated":false,"_reserved_1":62474288},"action":{"id":"981255","msg":"Detects MSSQL code execution and information gathering attempts","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62427488}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:,.*?[)\\da-f\\\"'`´’‘][\\\"'`´’‘](?:[\\\"'`´’‘].*?[\\\"'`´’‘]|\\Z|[^\\\"'`´’‘]+))|(?:\\Wselect.+\\W*?from)|((?:select|create|rename|truncate|load|alter|delete|update|insert|desc)\\s*?\\(\\s*?space\\s*?\\())","is_regex":true,"is_negated":false,"_reserved_1":62428624},"action":{"id":"981257","msg":"Detects MySQL comment-/space-obfuscated injections and backtick termination","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62429808}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:@.+=\\s*?\\(\\s*?select)|(?:\\d+\\s*?(x?or|div|like|between|and)\\s*?\\d+\\s*?[\\-+])|(?:\\/\\w+;?\\s+(?:having|and|x?or|div|like|between|and|select)\\W)|(?:\\d\\s+group\\s+by.+\\()|(?:(?:;|#|--)\\s*?(?:drop|alter))|(?:(?:;|#|--)\\s*?(?:update|insert)\\s*?\\w{2,})|(?:[^\\w]SET\\s*?@\\w+)|(?:(?:n?and|x?x?or|div|like|between|and|not |\\|\\||\\&\\&)[\\s(]+\\w+[\\s)]*?[!=+]+[\\s\\d]*?[\\\"'`´’‘=()]))","is_regex":true,"is_negated":false,"_reserved_1":62437696},"action":{"id":"981248","msg":"Detects chained SQL injection attempts 1/2","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62433520}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:^(-0000023456|4294967295|4294967296|2147483648|2147483647|0000012345|-2147483648|-2147483649|0000023456|2.2.90738585072007e-308|1e309)$))","is_regex":true,"is_negated":false,"_reserved_1":62457872},"action":{"id":"981277","msg":"Looking for integer overflow attacks, these are taken from skipfish, except 2.2.90738585072007e-308 is the \\\"magic number\\\" crash","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62459728}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:(select|;)\\s+(?:benchmark|if|sleep)\\s*?\\(\\s*?\\(?\\s*?\\w+))","is_regex":true,"is_negated":false,"_reserved_1":62462992},"action":{"id":"981250","msg":"Detects SQL benchmark and sleep injection attempts including conditional queries","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62463632}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:[\\s()]case\\s*?\\()|(?:\\)\\s*?like\\s*?\\()|(?:having\\s*?[^\\s]+\\s*?[^\\w\\s])|(?:if\\s?\\([\\d\\w]\\s*?[=<>~]))","is_regex":true,"is_negated":false,"_reserved_1":62451648},"action":{"id":"981241","msg":"Detects conditional SQL injection attempts","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62452512}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:alter\\s*?\\w+.*?character\\s+set\\s+\\w+)|([\\\"'`´’‘];\\s*?waitfor\\s+time\\s+[\\\"'`´’‘])|(?:[\\\"'`´’‘];.*?:\\s*?goto))","is_regex":true,"is_negated":false,"_reserved_1":62456432},"action":{"id":"981252","msg":"Detects MySQL charset switch and MSSQL DoS attempts","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62486096}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:merge.*?using\\s*?\\()|(execute\\s*?immediate\\s*?[\\\"'`´’‘])|(?:\\W+\\d*?\\s*?having\\s*?[^\\s\\-])|(?:match\\s*?[\\w(),+-]+\\s*?against\\s*?\\())","is_regex":true,"is_negated":false,"_reserved_1":62489840},"action":{"id":"981256","msg":"Detects MATCH AGAINST, MERGE, EXECUTE IMMEDIATE and HAVING injections","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62490720}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:union\\s*?(?:all|distinct|[(!@]*?)?\\s*?[([]*?\\s*?select\\s+)|(?:\\w+\\s+like\\s+[\\\"'`´’‘])|(?:like\\s*?[\\\"'`´’‘]\\%)|(?:[\\\"'`´’‘]\\s*?like\\W*?[\\\"'`´’‘\\d])|(?:[\\\"'`´’‘]\\s*?(?:n?and|x?x?or|div|like|between|and|not |\\|\\||\\&\\&)\\s+[\\s\\w]+=\\s*?\\w+\\s*?having\\s+)|(?:[\\\"'`´’‘]\\s*?\\*\\s*?\\w+\\W+[\\\"'`´’‘])|(?:[\\\"'`´’‘]\\s*?[^?\\w\\s=.,;)(]+\\s*?[(@\\\"'`´’‘]*?\\s*?\\w+\\W+\\w)|(?:select\\s+?[\\[\\]()\\s\\w\\.,\\\"'`´’‘-]+from\\s+)|(?:find_in_set\\s*?\\())","is_regex":true,"is_negated":false,"_reserved_1":62511392},"action":{"id":"981245","msg":"Detects basic SQL authentication bypass attempts 2/3","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62513296}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:(union(.*?)select(.*?)from)))","is_regex":true,"is_negated":false,"_reserved_1":62510480},"action":{"id":"981276","msg":"Looking for basic sql injection. Common attack string for mysql, oracle and others.","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62504288}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:select\\s*?pg_sleep)|(?:waitfor\\s*?delay\\s?[\\\"'`´’‘]+\\s?\\d)|(?:;\\s*?shutdown\\s*?(?:;|--|#|\\/\\*|{)))","is_regex":true,"is_negated":false,"_reserved_1":62499408},"action":{"id":"981254","msg":"Detects Postgres pg_sleep injection, waitfor delay attacks and database shutdown attempts","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62500192}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:\\[\\$(?:ne|eq|lte?|gte?|n?in|mod|all|size|exists|type|slice|x?or|div|like|between|and)\\]))","is_regex":true,"is_negated":false,"_reserved_1":62378016},"action":{"id":"981270","msg":"Finds basic MongoDB SQL injection attempts","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62379856}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:\\)\\s*?when\\s*?\\d+\\s*?then)|(?:[\\\"'`´’‘]\\s*?(?:#|--|{))|(?:\\/\\*!\\s?\\d+)|(?:ch(?:a)?r\\s*?\\(\\s*?\\d)|(?:(?:(n?and|x?x?or|div|like|between|and|not)\\s+|\\|\\||\\&\\&)\\s*?\\w+\\())","is_regex":true,"is_negated":false,"_reserved_1":62377632},"action":{"id":"981240","msg":"Detects MySQL comments, conditions and ch(a)r injections","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62376096}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:[\\\"'`´’‘]\\s+and\\s*?=\\W)|(?:\\(\\s*?select\\s*?\\w+\\s*?\\()|(?:\\*\\/from)|(?:\\+\\s*?\\d+\\s*?\\+\\s*?@)|(?:\\w[\\\"'`´’‘]\\s*?(?:[-+=|@]+\\s*?)+[\\d(])|(?:coalesce\\s*?\\(|@@\\w+\\s*?[^\\w\\s])|(?:\\W!+[\\\"'`´’‘]\\w)|(?:[\\\"'`´’‘];\\s*?(?:if|while|begin))|(?:[\\\"'`´’‘][\\s\\d]+=\\s*?\\d)|(?:order\\s+by\\s+if\\w*?\\s*?\\()|(?:[\\s(]+case\\d*?\\W.+[tw]hen[\\s(]))","is_regex":true,"is_negated":false,"_reserved_1":62376272},"action":{"id":"981249","msg":"Detects chained SQL injection attempts 2/2","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62384912}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:procedure\\s+analyse\\s*?\\()|(?:;\\s*?(declare|open)\\s+[\\w-]+)|(?:create\\s+(procedure|function)\\s*?\\w+\\s*?\\(\\s*?\\)\\s*?-)|(?:declare[^\\w]+[@#]\\s*?\\w+)|(exec\\s*?\\(\\s*?@))","is_regex":true,"is_negated":false,"_reserved_1":62392560},"action":{"id":"981253","msg":"Detects MySQL and PostgreSQL stored procedure/function injections","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62393648}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:[\\\"'`´’‘]\\s*?(x?or|div|like|between|and)\\s*?[\\\"'`´’‘]?\\d)|(?:\\\\\\\\x(?:23|27|3d))|(?:^.?[\\\"'`´’‘]$)|(?:(?:^[\\\"'`´’‘\\\\\\\\]*?(?:[\\d\\\"'`´’‘]+|[^\\\"'`´’‘]+[\\\"'`´’‘]))+\\s*?(?:n?and|x?x?or|div|like|between|and|not|\\|\\||\\&\\&)\\s*?[\\w\\\"'`´’‘][+&!@(),.-])|(?:[^\\w\\s]\\w+\\s*?[|-]\\s*?[\\\"'`´’‘]\\s*?\\w)|(?:@\\w+\\s+(and|x?or|div|like|between|and)\\s*?[\\\"'`´’‘\\d]+)|(?:@[\\w-]+\\s(and|x?or|div|like|between|and)\\s*?[^\\w\\s])|(?:[^\\w\\s:]\\s*?\\d\\W+[^\\w\\s]\\s*?[\\\"'`´’‘].)|(?:\\Winformation_schema|table_name\\W))","is_regex":true,"is_negated":false,"_reserved_1":62414496},"action":{"id":"981242","msg":"Detects classic SQL injection probings 1/2","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62411904}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:in\\s*?\\(+\\s*?select)|(?:(?:n?and|x?x?or|div|like|between|and|not |\\|\\||\\&\\&)\\s+[\\s\\w+]+(?:regexp\\s*?\\(|sounds\\s+like\\s*?[\\\"'`´’‘]|[=\\d]+x))|([\\\"'`´’‘]\\s*?\\d\\s*?(?:--|#))|(?:[\\\"'`´’‘][\\%&<>^=]+\\d\\s*?(=|x?or|div|like|between|and))|(?:[\\\"'`´’‘]\\W+[\\w+-]+\\s*?=\\s*?\\d\\W+[\\\"'`´’‘])|(?:[\\\"'`´’‘]\\s*?is\\s*?\\d.+[\\\"'`´’‘]?\\w)|(?:[\\\"'`´’‘]\\|?[\\w-]{3,}[^\\w\\s.,]+[\\\"'`´’‘])|(?:[\\\"'`´’‘]\\s*?is\\s*?[\\d.]+\\s*?\\W.*?[\\\"'`´’‘]))","is_regex":true,"is_negated":false,"_reserved_1":62585296},"action":{"id":"981246","msg":"Detects basic SQL authentication bypass attempts 3/3","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62587472}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:create\\s+function\\s+\\w+\\s+returns)|(?:;\\s*?(?:select|create|rename|truncate|load|alter|delete|update|insert|desc)\\s*?[\\[(]?\\w{2,}))","is_regex":true,"is_negated":false,"_reserved_1":62592208},"action":{"id":"981251","msg":"Detects MySQL UDF injection and other data/structure manipulation attempts","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62592928}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:[\\d\\W]\\s+as\\s*?[\\\"'`´’‘\\w]+\\s*?from)|(?:^[\\W\\d]+\\s*?(?:union|select|create|rename|truncate|load|alter|delete|update|insert|desc))|(?:(?:select|create|rename|truncate|load|alter|delete|update|insert|desc)\\s+(?:(?:group_)concat|char|load_file)\\s?\\(?)|(?:end\\s*?\\);)|([\\\"'`´’‘]\\s+regexp\\W)|(?:[\\s(]load_file\\s*?\\())","is_regex":true,"is_negated":false,"_reserved_1":62407008},"action":{"id":"981247","msg":"Detects concatenated basic SQL injection and SQLLFI attempts","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_COOKIES","match":[{"is_negated":false,"is_regex":false},{"value":"__utm","is_negated":true,"is_regex":true,"_reserved_1":62408992}],"is_count":false},{"type":"REQUEST_COOKIES_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS_NAMES","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"ARGS","match":[{"is_negated":false,"is_regex":false}],"is_count":false},{"type":"XML","match":[{"value":"/*","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"(?i:(?:[\\\"'`´’‘]\\s*?\\*.+(?:x?or|div|like|between|and|id)\\W*?[\\\"'`´’‘]\\d)|(?:\\^[\\\"'`´’‘])|(?:^[\\w\\s\\\"'`´’‘-]+(?<=and\\s)(?<=or|xor|div|like|between|and\\s)(?<=xor\\s)(?<=nand\\s)(?<=not\\s)(?<=\\|\\|)(?<=\\&\\&)\\w+\\()|(?:[\\\"'`´’‘][\\s\\d]*?[^\\w\\s]+\\W*?\\d\\W*?.*?[\\\"'`´’‘\\d])|(?:[\\\"'`´’‘]\\s*?[^\\w\\s?]+\\s*?[^\\w\\s]+\\s*?[\\\"'`´’‘])|(?:[\\\"'`´’‘]\\s*?[^\\w\\s]+\\s*?[\\W\\d].*?(?:#|--))|(?:[\\\"'`´’‘].*?\\*\\s*?\\d)|(?:[\\\"'`´’‘]\\s*?(x?or|div|like|between|and)\\s[^\\d]+[\\w-]+.*?\\d)|(?:[()\\*<>%+-][\\w-]+[^\\w\\s]+[\\\"'`´’‘][^,]))","is_regex":true,"is_negated":false,"_reserved_1":62612736},"action":{"id":"981243","msg":"Detects classic SQL injection probings 2/2","action_type":"BLOCK","capture":true,"phase":2,"file":"modsecurity_crs_41_sql_injection_attacks.conf","severity":"2","tag":["OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"setvar":[{"scope":"TX","var":"msg","op":"ASSIGN","val":"%{rule.id}-%{rule.msg}"},{"scope":"TX","var":"sql_injection_score","op":"INCREMENT","val":"1"},{"scope":"TX","var":"anomaly_score","op":"INCREMENT","val":"%{tx.critical_anomaly_score}"},{"scope":"TX","var":"%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}","op":"ASSIGN","val":"%{tx.0}"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","t":["NONE","URLDECODEUNI"]},"hidden":false}}]}